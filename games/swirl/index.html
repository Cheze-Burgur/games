<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Swirl</title>
  <link type="stylesheet", href="styles.css">
</head>

<body>
  <div id="controls">
    <label>
      Speed: <input type="range" id="speedSlider" min="0.1" max="3" step="0.01" value="0.25">
      <span id="speedValue" class="value">0.25</span>
    </label>
    <label>
      Gravity Strength: <input type="range" id="gravitySlider" min="0.1" max="3" step="0.1" value="1.5">
      <span id="gravityValue" class="value">1.5</span>
    </label>
    <label>
      Particles per Click: <input type="range" id="spawnSlider" min="1" max="50" step="1" value="25">
      <span id="spawnValue" class="value">25</span>
    </label>
    <button id="resetButton">Reset (R)</button>
  </div>
  <canvas id="canvas"></canvas>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [];
    let mouse = { x: canvas.width / 2, y: canvas.height / 2 };

    // Adjustable values
    let speed = 0.25;
    let gravityStrength = 1.5;

    class Particle {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random() - 0.5) * 2;
        this.vy = (Math.random() - 0.5) * 2;
        this.color = color;
        this.size = Math.random() * 3 + 2;
      }
      update() {
        let dx = mouse.x - this.x;
        let dy = mouse.y - this.y;
        let dist = Math.sqrt(dx * dx + dy * dy);
        let force = Math.min((200 * gravityStrength) / (dist * dist), 0.05 * gravityStrength);
        this.vx += dx * force * speed;
        this.vy += dy * force * speed;

        this.x += this.vx * speed;
        this.y += this.vy * speed;

        // wrap around screen
        if (this.x < 0) this.x = canvas.width;
        if (this.x > canvas.width) this.x = 0;
        if (this.y < 0) this.y = canvas.height;
        if (this.y > canvas.height) this.y = 0;
      }
      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
      }
    }

    function randomColor() {
      const colors = ['#ff6f61', '#6b5b95', '#88b04b', '#f7cac9', '#92a8d1', '#f7786b', '#ffcc5c'];
      return colors[Math.floor(Math.random() * colors.length)];
    }

    let spawnRate = 25;
    function spawnParticles(x, y) {
      for (let i = 0; i < spawnRate; i++) {
        particles.push(new Particle(x, y, randomColor()));
      }
    }

    function resetParticles() {
      particles = [];
      spawnParticles(canvas.width / 2, canvas.height / 2);
    }

    canvas.addEventListener('mousemove', e => {
      mouse.x = e.clientX;
      mouse.y = e.clientY;
    });

    canvas.addEventListener('click', e => {
      spawnParticles(e.clientX, e.clientY);
    });

    function animate() {
      ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      particles.forEach(p => {
        p.update();
        p.draw();
      });

      requestAnimationFrame(animate);
    }

    // Start with some particles
    resetParticles();
    animate();

    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });

    // Slider controls with display
    const speedSlider = document.getElementById('speedSlider');
    const gravitySlider = document.getElementById('gravitySlider');
    const speedValue = document.getElementById('speedValue');
    const gravityValue = document.getElementById('gravityValue');

    speedSlider.addEventListener('input', e => {
      speed = parseFloat(e.target.value);
      speedValue.textContent = speed.toFixed(1);
    });

    gravitySlider.addEventListener('input', e => {
      gravityStrength = parseFloat(e.target.value);
      gravityValue.textContent = gravityStrength.toFixed(1);
    });

    spawnSlider.addEventListener('input', e => {
      spawnRate = parseFloat(e.target.value);
      spawnValue.textContent = spawnRate.toFixed(1);
    });

    // Reset button
    document.getElementById('resetButton').addEventListener('click', resetParticles);

    // Reset with R key
    window.addEventListener('keydown', e => {
      if (e.key.toLowerCase() === 'r') {
        resetParticles();
      }
    });
  </script>
</body>

</html>